"use strict";(self.webpackChunkgraphql_mesh_gateway=self.webpackChunkgraphql_mesh_gateway||[]).push([[5329],{9208:function(e,a,n){n.r(a),n.d(a,{_frontmatter:function(){return l},default:function(){return h}});var o=n(87462),t=n(45987),r=(n(35776),n(3905)),i=n(91515);const s=["components"],l={},m=(p="InlineAlert",function(e){return console.warn("Component "+p+" was not imported, exported, or provided by MDXProvider as global scope"),(0,r.mdx)("div",e)});var p;const d={_frontmatter:l},c=i.Z;function h(e){let{components:a}=e,n=(0,t.Z)(e,s);return(0,r.mdx)(c,(0,o.Z)({},d,n,{components:a,mdxType:"MDXLayout"}),(0,r.mdx)("h1",{id:"work-with-your-mesh"},"Work with your mesh"),(0,r.mdx)("p",null,"This page describes ways you can work with meshes that contain optional processes that are not required for ",(0,r.mdx)("a",{parentName:"p",href:"create-mesh.md"},"mesh creation"),"."),(0,r.mdx)("h2",{id:"retrieve-a-previously-created-meshid-or-mesh-endpoint-url"},"Retrieve a previously created ",(0,r.mdx)("inlineCode",{parentName:"h2"},"meshId")," or mesh endpoint URL"),(0,r.mdx)("p",null,"If you need to retrieve a ",(0,r.mdx)("inlineCode",{parentName:"p"},"meshId")," or mesh endpoint URL from a previously created mesh, use the following command to display your mesh details in the console."),(0,r.mdx)("pre",null,(0,r.mdx)("code",{parentName:"pre",className:"language-bash"},"aio api-mesh:describe\n")),(0,r.mdx)("p",null,"By default, the command describes the mesh in the selected project and workspace."),(0,r.mdx)("p",null,"If no project or workspace is selected, the command returns a list of projects. Use the arrow and enter keys to select your project and organization. Alternatively, you can type to search for your project and workspace."),(0,r.mdx)("h2",{id:"move-a-mesh-to-another-workspace"},"Move a mesh to another workspace"),(0,r.mdx)("p",null,"You may need to move a mesh from one workspace to another, for example from ",(0,r.mdx)("inlineCode",{parentName:"p"},"stage")," to ",(0,r.mdx)("inlineCode",{parentName:"p"},"production"),". The following process describes how to copy a mesh from one workspace and duplicate it in another workspace."),(0,r.mdx)("ol",null,(0,r.mdx)("li",{parentName:"ol"},(0,r.mdx)("p",{parentName:"li"},(0,r.mdx)("a",{parentName:"p",href:"#select-a-project-or-workspace"},"Select the workspace")," that contains the mesh you want to copy.")),(0,r.mdx)("li",{parentName:"ol"},(0,r.mdx)("p",{parentName:"li"},(0,r.mdx)("a",{parentName:"p",href:"#retrieve-a-previously-created-meshid-or-mesh-endpoint-url"},"Retrieve")," your previously created mesh by running the following ",(0,r.mdx)("a",{parentName:"p",href:"command-reference.md#aio-api-meshget"},(0,r.mdx)("inlineCode",{parentName:"a"},"get")," command"),"."),(0,r.mdx)("pre",{parentName:"li"},(0,r.mdx)("code",{parentName:"pre",className:"language-bash"},"aio api-mesh:get download.json\n")),(0,r.mdx)("p",{parentName:"li"},"This command creates a file named ",(0,r.mdx)("inlineCode",{parentName:"p"},"download.json")," that contains a copy of the mesh from the selected workspace.")),(0,r.mdx)("li",{parentName:"ol"},(0,r.mdx)("p",{parentName:"li"},"Run the following command and select the ",(0,r.mdx)("inlineCode",{parentName:"p"},"production")," or target workspace, see ",(0,r.mdx)("a",{parentName:"p",href:"#select-a-project-or-workspace"},"select a project or workspace")," for more information."),(0,r.mdx)("pre",{parentName:"li"},(0,r.mdx)("code",{parentName:"pre",className:"language-bash"},"aio console:workspace:select\n"))),(0,r.mdx)("li",{parentName:"ol"},(0,r.mdx)("p",{parentName:"li"},"Run the ",(0,r.mdx)("a",{parentName:"p",href:"create-mesh.md#create-a-mesh"},"create")," command and reference the previously created file."),(0,r.mdx)("pre",{parentName:"li"},(0,r.mdx)("code",{parentName:"pre",className:"language-bash"},"aio api-mesh:create download.json\n")))),(0,r.mdx)("h2",{id:"include-httpdetails-in-query-responses"},"Include ",(0,r.mdx)("inlineCode",{parentName:"h2"},"httpDetails")," in query responses"),(0,r.mdx)("p",null,"Adding the ",(0,r.mdx)("inlineCode",{parentName:"p"},"includeHTTPDetails")," flag to your JSON mesh configuration file determines if ",(0,r.mdx)("inlineCode",{parentName:"p"},"httpDetails")," information is included in query responses."),(0,r.mdx)("p",null,"Setting ",(0,r.mdx)("inlineCode",{parentName:"p"},"includeHTTPDetails")," to ",(0,r.mdx)("inlineCode",{parentName:"p"},"true")," adds information like ",(0,r.mdx)("inlineCode",{parentName:"p"},"responseTime")," and response headers to every query response. Setting ",(0,r.mdx)("inlineCode",{parentName:"p"},"includeHTTPDetails")," to ",(0,r.mdx)("inlineCode",{parentName:"p"},"false")," prevents users who query your mesh from accessing this information. If you do not include the ",(0,r.mdx)("inlineCode",{parentName:"p"},"includeHTTPDetails")," property in your mesh, the setting defaults to false."),(0,r.mdx)("p",null,"The following example mesh indicates the location of the ",(0,r.mdx)("inlineCode",{parentName:"p"},"includeHTTPDetails")," flag."),(0,r.mdx)("pre",null,(0,r.mdx)("code",{parentName:"pre",className:"language-json"},'{\n    "meshConfig": {\n        "responseConfig":{\n            "includeHTTPDetails":true\n\n        },\n        "sources":[\n            {\n                "name":"Venia",\n                "handler": {\n                    "graphql": \n                    {\n                        "endpoint":"https://venia.magento.com/graphql"\n                    }\n                }\n            }\n        ]\n    }\n}\n')),(0,r.mdx)("p",null,"When you query a mesh with ",(0,r.mdx)("inlineCode",{parentName:"p"},"includeHTTPDetails")," set to ",(0,r.mdx)("inlineCode",{parentName:"p"},"true"),", the response will include an ",(0,r.mdx)("inlineCode",{parentName:"p"},"httpDetails")," section with the following information:"),(0,r.mdx)("ul",null,(0,r.mdx)("li",{parentName:"ul"},(0,r.mdx)("inlineCode",{parentName:"li"},"sourceName")),(0,r.mdx)("li",{parentName:"ul"},(0,r.mdx)("inlineCode",{parentName:"li"},"request")),(0,r.mdx)("li",{parentName:"ul"},(0,r.mdx)("inlineCode",{parentName:"li"},"response")),(0,r.mdx)("li",{parentName:"ul"},(0,r.mdx)("inlineCode",{parentName:"li"},"responseTime"))),(0,r.mdx)("p",null,"The following example includes some additional information a user can receive as part of the response. The exact response varies, depending on your source handlers, headers, and other customizations."),(0,r.mdx)("pre",null,(0,r.mdx)("code",{parentName:"pre",className:"language-json"},'{   \n "data": {\n        "storeConfig": {\n            "timezone": "America/Los_Angeles"\n        }\n    },\n    "extensions": {\n        "httpDetails": [\n            {\n                "sourceName": "Venia",\n                "request": {\n                    "timestamp": 1676489418840,\n                    "url": "https://venia.magento.com/graphql",\n                    "method": "POST",\n                    "headers": {\n                        "accept": "application/graphql-response+json, application/json, multipart/mixed",\n                        "content-type": "application/json"\n                    }\n                },\n                "response": {\n                    "timestamp": 1676489419070,\n                    "status": 200,\n                    "statusText": "OK",\n                    "headers": {\n                        "accept-ranges": "bytes",\n                        "cache-control": "max-age=0, must-revalidate, no-cache, no-store",\n                        "connection": "keep-alive",\n                        "content-length": "63",\n                        "content-type": "application/json",\n                        "date": "Wed, 15 Feb 2023 19:30:19 GMT",\n                        "expires": "Tue, 15 Feb 2022 19:30:19 GMT",\n                    }\n                },\n                "responseTime": 230\n            }\n        ]\n    }\n}\n')),(0,r.mdx)("h2",{id:"projects-and-workspaces"},"Projects and workspaces"),(0,r.mdx)(m,{variant:"info",slots:"text",mdxType:"InlineAlert"}),(0,r.mdx)("p",null,"When creating a mesh for the first time, you must select the project and workspace that you want to create the mesh in. Alternatively, you can use ",(0,r.mdx)("a",{parentName:"p",href:"https://github.com/adobe/aio-cli#commands"},"aio commands")," to manually select a project or workspace, list the current selections, or remove the currently selected project or workspace from the cache."),(0,r.mdx)("h3",{id:"view-the-cached-project-and-workspace"},"View the cached project and workspace"),(0,r.mdx)("p",null,"To see your current cache configuration, use the ",(0,r.mdx)("a",{parentName:"p",href:"https://github.com/adobe/aio-cli#aio-configget-key"},(0,r.mdx)("inlineCode",{parentName:"a"},"aio config:get console"))," command, which includes the currently selected organization, project, and workspace."),(0,r.mdx)("p",null,"You can view a list of available projects in your current organization by running the ",(0,r.mdx)("a",{parentName:"p",href:"https://github.com/adobe/aio-cli-plugin-console#aio-consoleprojectlist"},(0,r.mdx)("inlineCode",{parentName:"a"},"aio console:project:list"))," command."),(0,r.mdx)("p",null,"To view a list of available workspaces in the current project, run the ",(0,r.mdx)("a",{parentName:"p",href:"https://github.com/adobe/aio-cli-plugin-console#aio-consoleworkspacelist"},(0,r.mdx)("inlineCode",{parentName:"a"},"aio console:workspace:list"))," command."),(0,r.mdx)("h3",{id:"select-a-project-or-workspace"},"Select a project or workspace"),(0,r.mdx)("p",null,"By ",(0,r.mdx)("a",{parentName:"p",href:"https://developer.adobe.com/app-builder/docs/getting_started/first_app/#2-creating-a-new-project-on-developer-console"},"default"),", projects have a ",(0,r.mdx)("inlineCode",{parentName:"p"},"production")," and a ",(0,r.mdx)("inlineCode",{parentName:"p"},"stage")," workspace. You can also ",(0,r.mdx)("a",{parentName:"p",href:"https://developer.adobe.com/developer-console/docs/guides/projects/projects-template/#add-a-workspace"},"create your own workspaces"),". If you do not know which workspace to use, use the ",(0,r.mdx)("inlineCode",{parentName:"p"},"stage")," workspace."),(0,r.mdx)("p",null,"To change the selected project, use the ",(0,r.mdx)("a",{parentName:"p",href:"https://github.com/adobe/aio-cli#aio-consoleprojectselect-projectidorname"},(0,r.mdx)("inlineCode",{parentName:"a"},"aio console:project:select"))," command, which prompts you to select your project from a list."),(0,r.mdx)("p",null,"To change the selected workspace, use the ",(0,r.mdx)("a",{parentName:"p",href:"https://github.com/adobe/aio-cli#aio-consoleworkspaceselect-workspaceidorname"},(0,r.mdx)("inlineCode",{parentName:"a"},"aio console:workspace:select"))," command, which prompts you to select your workspace from a list."),(0,r.mdx)(m,{variant:"info",slots:"text",mdxType:"InlineAlert"}),(0,r.mdx)("p",null,"You must select a project before you select a workspace."),(0,r.mdx)("h3",{id:"delete-a-cached-project-or-workspace"},"Delete a cached project or workspace"),(0,r.mdx)("p",null,"If you want to clear a previously selected project or workspace from your cache, use the ",(0,r.mdx)("a",{parentName:"p",href:"https://github.com/adobe/aio-cli#aio-configdelete-keys"},(0,r.mdx)("inlineCode",{parentName:"a"},"aio config:delete"))," followed by the object you want to remove from your cached config."),(0,r.mdx)("p",null,"For example:"),(0,r.mdx)("ul",null,(0,r.mdx)("li",{parentName:"ul"},(0,r.mdx)("inlineCode",{parentName:"li"},"aio config:delete console.project")," Removes the current project from the cache."),(0,r.mdx)("li",{parentName:"ul"},(0,r.mdx)("inlineCode",{parentName:"li"},"aio config:delete console.workspace")," Removes the current workspace from the cache.")),(0,r.mdx)("h2",{id:"aliasing"},"Aliasing"),(0,r.mdx)("p",null,"In GraphQL you can use ",(0,r.mdx)("a",{parentName:"p",href:"https://graphql.org/learn/queries/#aliases"},"aliasing")," in your query to rename fields and avoid fields with conflicting names. This is particularly useful for API Mesh because aliasing allows you to rename fields when querying."),(0,r.mdx)(m,{variant:"info",slots:"text",mdxType:"InlineAlert"}),(0,r.mdx)("p",null,"You can also rename field names within your mesh by using the ",(0,r.mdx)("a",{parentName:"p",href:"../reference/transforms/rename.md"},(0,r.mdx)("inlineCode",{parentName:"a"},"rename"))," and ",(0,r.mdx)("a",{parentName:"p",href:"../reference/transforms/prefix.md"},(0,r.mdx)("inlineCode",{parentName:"a"},"prefix"))," transforms."),(0,r.mdx)("p",null,"The following example renames the ",(0,r.mdx)("inlineCode",{parentName:"p"},"name")," field to ",(0,r.mdx)("inlineCode",{parentName:"p"},"productName"),"."),(0,r.mdx)("pre",null,(0,r.mdx)("code",{parentName:"pre",className:"language-graphql"},'{\n products(search:"tops"){\n   items {\n       productName:name\n       sku\n     }\n   } \n } \n')),(0,r.mdx)("p",null,"Due to the limitations of API Mesh, responses contain both the newly created alias field and the original field. For example, the previous query produces the following response that contains both the aliased field, ",(0,r.mdx)("inlineCode",{parentName:"p"},"productName"),", and the original field, ",(0,r.mdx)("inlineCode",{parentName:"p"},"name"),"."),(0,r.mdx)("pre",null,(0,r.mdx)("code",{parentName:"pre",className:"language-json"},'{\n  "data": {\n    "products": {\n      "CommerceItems": [\n        {\n          "productName": "Vitalia Top",\n          "sku": "VT10",\n          "name": "Vitalia Top"\n        },\n        {\n          "productName": "Jillian Top",\n          "sku": "VT12",\n          "name": "Jillian Top"\n        }\n      ]\n    }\n  }\n}\n')),(0,r.mdx)("h2",{id:"chained-mutations"},"Chained mutations"),(0,r.mdx)("p",null,"When you query a mesh using chained mutations, the mesh makes a separate call to the source for each mutation. This happens because GraphQL requests execute when the GraphQL server receives them, instead of proxying the calls. Because API Mesh supports multiple sources, it evaluates batched mutations and separates the information based on the source it is associated with."),(0,r.mdx)("p",null,"These mutations are executed sequentially, calling one source after the other. When you call a source directly, it will only need one API call, but it will execute the batch mutations sequentially by calling their respective resolvers. These calls are more overt in API Mesh, because they are made by a network call, instead of an internal call. This means you will see multiple calls for chained mutations."))}h.isMDXComponent=!0}}]);
//# sourceMappingURL=component---src-pages-gateway-work-with-mesh-md-f7c11586204a60b5d7d3.js.map