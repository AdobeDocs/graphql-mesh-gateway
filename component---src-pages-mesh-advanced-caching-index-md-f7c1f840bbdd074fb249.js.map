{"version":3,"file":"component---src-pages-mesh-advanced-caching-index-md-f7c1f840bbdd074fb249.js","mappings":"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","sources":["webpack://graphql-mesh-gateway/./src/pages/mesh/advanced/caching/index.md"],"sourcesContent":["import * as React from 'react'\n  /* @jsx mdx */\nimport { mdx } from '@mdx-js/react';\n/* @jsxRuntime classic */\n\n/* @jsx mdx */\n\nimport DefaultLayout from \"/home/runner/work/graphql-mesh-gateway/graphql-mesh-gateway/node_modules/@adobe/gatsby-theme-aio/src/components/MDXFilter/index.js\";\nexport const _frontmatter = {};\n\nconst makeShortcode = name => function MDXDefaultShortcode(props) {\n  console.warn(\"Component \" + name + \" was not imported, exported, or provided by MDXProvider as global scope\");\n  return <div {...props} />;\n};\n\nconst InlineAlert = makeShortcode(\"InlineAlert\");\nconst layoutProps = {\n  _frontmatter\n};\nconst MDXLayout = DefaultLayout;\nexport default function MDXContent({\n  components,\n  ...props\n}) {\n  return <MDXLayout {...layoutProps} {...props} components={components} mdxType=\"MDXLayout\">\n\n\n    <h1 {...{\n      \"id\": \"cache-control-headers\"\n    }}>{`Cache-control headers`}</h1>\n    <p>{`API Mesh for Adobe Developer App Builder supports dynamic content caching if you provide a content delivery network (CDN), such as `}<a parentName=\"p\" {...{\n        \"href\": \"./fastly.md\"\n      }}>{`Fastly`}</a>{`. Dynamic content caching helps improve website load times and reduces consumption costs associated with bandwidth.`}</p>\n    <InlineAlert variant=\"info\" slots=\"text\" mdxType=\"InlineAlert\" />\n    <p>{`When using a CDN, you must invalidate the cache after modifying a mesh configuration, or you will receive stale information.`}</p>\n    <h2 {...{\n      \"id\": \"understanding-cache-control-headers\"\n    }}>{`Understanding cache-control headers`}</h2>\n    <p>{`A CDN's cache-control headers determine how queried information is cached.`}</p>\n    <p>{`When a browser or a GET request accesses a URL, the site's response headers typically include a `}<inlineCode parentName=\"p\">{`cache-control`}</inlineCode>{` header, which determines how long the site will allow its data to be cached. For example, a website could have the following response header:`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-html\"\n      }}>{`cache-control: max-age=0\n`}</code></pre>\n    <p>{`The `}<inlineCode parentName=\"p\">{`max-age=0`}</inlineCode>{` cache-control directive means that this site wants to serve `}<a parentName=\"p\" {...{\n        \"href\": \"https://developer.mozilla.org/en-US/docs/Web/HTTP/Caching#fresh_and_stale_based_on_age\"\n      }}>{`fresh`}</a>{` data until `}<inlineCode parentName=\"p\">{`0`}</inlineCode>{` seconds after the response is generated, which basically means it never wants to cache data. This could also be achieved with a `}<inlineCode parentName=\"p\">{`no-store`}</inlineCode>{` directive.`}</p>\n    <p>{`For more information on specific cache-control directives and how they can be used, see the `}<a parentName=\"p\" {...{\n        \"href\": \"https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Cache-Control\"\n      }}>{`Mozilla Developer Network's cache control guide`}</a>{`.`}</p>\n    <h2 {...{\n      \"id\": \"using-cache-control-headers-with-api-mesh\"\n    }}>{`Using cache-control headers with API Mesh`}</h2>\n    <p>{`API mesh users can add cache-control headers to `}<a parentName=\"p\" {...{\n        \"href\": \"#as-request-headers\"\n      }}>{`request headers`}</a>{` or to a `}<a parentName=\"p\" {...{\n        \"href\": \"#in-the-mesh-configuration-file\"\n      }}>{`mesh configuration file`}</a>{`.`}</p>\n    <InlineAlert variant=\"info\" slots=\"text\" mdxType=\"InlineAlert\" />\n    <p>{`Currently, query-level caching is not supported.`}</p>\n    <h3 {...{\n      \"id\": \"as-request-headers\"\n    }}>{`As request headers`}</h3>\n    <p>{`Use a mesh configuration similar to the example below to `}<a parentName=\"p\" {...{\n        \"href\": \"../headers.md#return-forwarded-headers\"\n      }}>{`return forwarded headers`}</a>{`.`}</p>\n    <InlineAlert variant=\"info\" slots=\"text\" mdxType=\"InlineAlert\" />\n    <p>{`You can also use a header value of `}<inlineCode parentName=\"p\">{`x-include-metadata=true`}</inlineCode>{` to return all headers.`}</p>\n    <p>{`When the response includes cache-control values, only the `}<a parentName=\"p\" {...{\n        \"href\": \"#how-conflicting-header-values-are-resolved\"\n      }}>{`most restrictive values`}</a>{` are returned.`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-json\"\n      }}>{`{\n  \"meshConfig\": {\n    \"responseConfig\": {\n        \"headers\": {\n      \"Cache-Control\": \"max-age=50,min-fresh=6,stale-if-error=20,public,must-revalidate\"\n        }\n    },\n    \"sources\": [\n      {\n        \"name\": \"venia\",\n        \"handler\": {\n          \"graphql\": {\n            \"endpoint\": \"https://venia.magento.com/graphql\"\n          }\n        }\n      }\n    ]\n  }\n}\n`}</code></pre>\n    <InlineAlert variant=\"info\" slots=\"text\" mdxType=\"InlineAlert\" />\n    <p>{`POST requests are not supported, and GET requests are limited to 2,048 characters.`}</p>\n    <h4 {...{\n      \"id\": \"how-conflicting-header-values-are-resolved\"\n    }}>{`How conflicting header values are resolved`}</h4>\n    <p>{`When cache-control header values from multiple sources conflict, API Mesh selects the lowest or most restrictive value. The following section explains which values are returned when `}<a parentName=\"p\" {...{\n        \"href\": \"https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Cache-Control\"\n      }}>{`cache-control directives`}</a>{` conflict.`}</p>\n    <p>{`The `}<inlineCode parentName=\"p\">{`no-store`}</inlineCode>{` directive supersedes all other directives. If your source's cache-control headers contain this directive, then the mesh does not return other headers.`}</p>\n    <p>{`If your source's cache-control headers contain conflicting values for the following directives, the mesh selects the lowest value:`}</p>\n    <ul>\n      <li parentName=\"ul\">\n        <p parentName=\"li\"><inlineCode parentName=\"p\">{`min-fresh`}</inlineCode></p>\n      </li>\n      <li parentName=\"ul\">\n        <p parentName=\"li\"><inlineCode parentName=\"p\">{`max-age`}</inlineCode></p>\n      </li>\n      <li parentName=\"ul\">\n        <p parentName=\"li\"><inlineCode parentName=\"p\">{`max-stale`}</inlineCode></p>\n      </li>\n      <li parentName=\"ul\">\n        <p parentName=\"li\"><inlineCode parentName=\"p\">{`s-maxage`}</inlineCode></p>\n      </li>\n      <li parentName=\"ul\">\n        <p parentName=\"li\"><inlineCode parentName=\"p\">{`stale-if-error`}</inlineCode></p>\n      </li>\n      <li parentName=\"ul\">\n        <p parentName=\"li\"><inlineCode parentName=\"p\">{`stale-while-revalidate`}</inlineCode></p>\n      </li>\n    </ul>\n    <p>{`If your source's cache-control headers contain any of the following directives, the mesh adds the directive to the `}<inlineCode parentName=\"p\">{`cache-control`}</inlineCode>{` response.`}</p>\n    <ul>\n      <li parentName=\"ul\">\n        <p parentName=\"li\"><inlineCode parentName=\"p\">{`public`}</inlineCode></p>\n      </li>\n      <li parentName=\"ul\">\n        <p parentName=\"li\"><inlineCode parentName=\"p\">{`private`}</inlineCode></p>\n      </li>\n      <li parentName=\"ul\">\n        <p parentName=\"li\"><inlineCode parentName=\"p\">{`immutable`}</inlineCode></p>\n      </li>\n      <li parentName=\"ul\">\n        <p parentName=\"li\"><inlineCode parentName=\"p\">{`no-cache`}</inlineCode></p>\n      </li>\n      <li parentName=\"ul\">\n        <p parentName=\"li\"><inlineCode parentName=\"p\">{`no-transform`}</inlineCode></p>\n      </li>\n      <li parentName=\"ul\">\n        <p parentName=\"li\"><inlineCode parentName=\"p\">{`must-revalidate`}</inlineCode></p>\n      </li>\n      <li parentName=\"ul\">\n        <p parentName=\"li\"><inlineCode parentName=\"p\">{`proxy-revalidate`}</inlineCode></p>\n      </li>\n      <li parentName=\"ul\">\n        <p parentName=\"li\"><inlineCode parentName=\"p\">{`must-understand`}</inlineCode></p>\n      </li>\n    </ul>\n    <p><strong parentName=\"p\">{`Examples`}</strong></p>\n    <p>{`The following example scenarios indicate the resulting `}<inlineCode parentName=\"p\">{`Response header`}</inlineCode>{` from two conflicting sources:`}</p>\n    <p>{`Example 1`}</p>\n    <ul>\n      <li parentName=\"ul\">\n        <p parentName=\"li\">{`Source 1 response headers`}</p>\n        <ul parentName=\"li\">\n          <li parentName=\"ul\">{`max-age=3600, stale-while-revalidate=60, stale-if-error=3600`}</li>\n        </ul>\n      </li>\n      <li parentName=\"ul\">\n        <p parentName=\"li\">{`Source 2 response headers`}</p>\n        <ul parentName=\"li\">\n          <li parentName=\"ul\">{`max-age:600, stale-if-error=60`}</li>\n        </ul>\n      </li>\n      <li parentName=\"ul\">\n        <p parentName=\"li\">{`Combined HTTP response headers`}</p>\n        <ul parentName=\"li\">\n          <li parentName=\"ul\">{`max-age=600, stale-while-revalidate=60, stale-if-error=60`}</li>\n        </ul>\n      </li>\n    </ul>\n    <p>{`Example 2`}</p>\n    <ul>\n      <li parentName=\"ul\">\n        <p parentName=\"li\">{`Source 1 response headers`}</p>\n        <ul parentName=\"li\">\n          <li parentName=\"ul\">{`max-age=3600, stale-while-revalidate=60, stale-if-error=3600`}</li>\n        </ul>\n      </li>\n      <li parentName=\"ul\">\n        <p parentName=\"li\">{`Source 2 response headers`}</p>\n        <ul parentName=\"li\">\n          <li parentName=\"ul\">{`no-store`}</li>\n        </ul>\n      </li>\n      <li parentName=\"ul\">\n        <p parentName=\"li\">{`Combined HTTP response headers`}</p>\n        <ul parentName=\"li\">\n          <li parentName=\"ul\">{`no-store`}</li>\n        </ul>\n      </li>\n    </ul>\n    <h3 {...{\n      \"id\": \"in-the-mesh-configuration-file\"\n    }}>{`In the mesh configuration file`}</h3>\n    <p>{`To set your own values for cache-control headers, add a `}<inlineCode parentName=\"p\">{`Cache-Control`}</inlineCode>{` key-value pair to the `}<inlineCode parentName=\"p\">{`responseConfig`}</inlineCode>{` object in your mesh configuration file.`}</p>\n    <InlineAlert variant=\"info\" slots=\"text\" mdxType=\"InlineAlert\" />\n    <p>{`Cache-control header values in your mesh configuration file take precedence over other conflicting values for your sources and are always included in the response.`}</p>\n    <h4 {...{\n      \"id\": \"mesh-example\"\n    }}>{`Mesh Example`}</h4>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-json\"\n      }}>{`{\n  \"meshConfig\": {\n    \"responseConfig\": {\n        \"headers\": {\n      \"Cache-Control\": \"max-age=50,min-fresh=6,stale-if-error=20,public,must-revalidate\"\n        }\n    },\n    \"sources\": [\n      {\n        \"name\": \"venia\",\n        \"handler\": {\n          \"graphql\": {\n            \"endpoint\": \"https://venia.magento.com/graphql\"\n          }\n        }\n      }\n    ]\n  }\n}\n`}</code></pre>\n\n    </MDXLayout>;\n}\n;\nMDXContent.isMDXComponent = true;\n      "],"names":["_frontmatter","InlineAlert","name","props","console","warn","layoutProps","MDXLayout","DefaultLayout","MDXContent","components","mdxType","parentName","variant","slots","isMDXComponent"],"sourceRoot":""}